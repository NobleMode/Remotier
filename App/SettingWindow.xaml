<Window x:Class="Remotier.SettingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialIcons="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
        Title="Remotier Settings" Height="500" Width="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{StaticResource BackgroundBrush}">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Orientation="Horizontal" Margin="0,0,0,20" HorizontalAlignment="Center">
            <materialIcons:MaterialIcon Kind="Cog" Width="24" Height="24" Foreground="{StaticResource AccentBrush}" Margin="0,0,10,0"/>
            <TextBlock Text="SETTINGS" FontSize="20" FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
        </StackPanel>

        <!-- Content -->
        <TabControl Grid.Row="1" Margin="0" Background="Transparent" BorderThickness="0">
            <!-- Account Tab -->
            <TabItem Header="Account" FontSize="14">
                <Grid Margin="10">
                    <StackPanel>
                        <TextBlock Text="Account Credentials" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource TextBrush}" Margin="0,0,0,10"/>
                        <Border Background="{StaticResource SurfaceBrush}" CornerRadius="5" Padding="15">
                            <StackPanel>
                                <TextBlock Text="Account Name" Foreground="#888888" Margin="0,0,0,5"/>
                                <TextBox x:Name="AccountNameBox" Height="30" Margin="0,0,0,15"/>
                                
                                <TextBlock Text="Account Password" Foreground="#888888" Margin="0,0,0,5"/>
                                <Grid Margin="0,0,0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <PasswordBox x:Name="AccountPasswordBox" Height="30" Padding="5"/>
                                    <TextBox x:Name="AccountPasswordVisibleBox" Height="30" Padding="5" Visibility="Collapsed"/>
                                    <ToggleButton x:Name="ShowPasswordToggle" Grid.Column="1" Width="30" Height="30" Margin="5,0,0,0" Background="Transparent" BorderThickness="0" Checked="ShowPassword_Checked" Unchecked="ShowPassword_Unchecked" Cursor="Hand">
                                        <materialIcons:MaterialIcon Kind="Eye" Width="16" Height="16" Foreground="{StaticResource AccentBrush}"/>
                                    </ToggleButton>
                                </Grid>
                                
                                <TextBlock x:Name="PasswordStatusText" Text="Status: Checking..." FontSize="11" Foreground="#AAAAAA" Margin="0,0,0,15"/>
                                
                                <Button Content="Save Credentials" Click="SaveAccount_Click" Height="30" Background="{StaticResource AccentBrush}" Foreground="White" BorderThickness="0" HorizontalAlignment="Left" Width="150" Cursor="Hand"/>
                                <TextBlock Text="Set matching credentials on trusted devices to bypass connection prompts." TextWrapping="Wrap" Foreground="#666666" FontSize="11" Margin="0,10,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Security Tab -->
            <TabItem Header="Security" FontSize="14">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <Grid Grid.Row="0" Margin="0,0,0,10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="Trusted Devices" FontSize="14" FontWeight="SemiBold" Foreground="#AAAAAA" Margin="0,0,0,5"/>
                        <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" CornerRadius="5" Padding="5">
                             <ListBox x:Name="TrustedDevicesList" Background="Transparent" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#3E3E42" CornerRadius="5" Padding="10" Margin="0,0,0,5">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel VerticalAlignment="Center">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialIcons:MaterialIcon Kind="LaptopAccount" Width="16" Height="16" Foreground="{StaticResource AccentBrush}" Margin="0,0,5,0"/>
                                                        <TextBlock Text="{Binding DeviceName}" FontWeight="Bold" Foreground="{StaticResource TextBrush}"/>
                                                    </StackPanel>
                                                    <TextBlock Text="{Binding LastSeen, StringFormat='Last Seen: {0:g}'}" FontSize="10" Foreground="#888888" Margin="21,2,0,0"/>
                                                </StackPanel>
                                                <Button Grid.Column="1" Click="RemoveTrusted_Click" Padding="8,4" Background="#333333" Margin="10,0,0,0" Cursor="Hand">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialIcons:MaterialIcon Kind="Delete" Width="12" Height="12" Foreground="#FF6666" Margin="0,0,5,0"/>
                                                        <TextBlock Text="Remove" FontSize="10" Foreground="#FF6666"/>
                                                    </StackPanel>
                                                </Button>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Border>
                    </Grid>

                    <Grid Grid.Row="2">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="Recent Connections" FontSize="14" FontWeight="SemiBold" Foreground="#AAAAAA" Margin="0,0,0,5"/>
                        <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" CornerRadius="5" Padding="5">
                             <ListBox x:Name="RecentConnectionsList" Background="Transparent" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#3E3E42" CornerRadius="5" Padding="10" Margin="0,0,0,5">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <StackPanel Orientation="Horizontal">
                                                         <materialIcons:MaterialIcon Kind="History" Width="16" Height="16" Foreground="#AAAAAA" Margin="0,0,5,0"/>
                                                         <TextBlock Text="{Binding DeviceName}" FontWeight="Bold" Foreground="{StaticResource TextBrush}"/>
                                                    </StackPanel>
                                                </StackPanel>
                                                <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                                                    <TextBlock Text="{Binding IpAddress}" FontSize="10" Foreground="#888888" HorizontalAlignment="Right"/>
                                                    <TextBlock Text="{Binding ConnectedAt, StringFormat='{}{0:g}'}" FontSize="10" Foreground="#666666" HorizontalAlignment="Right"/>
                                                </StackPanel>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                        </Border>
                    </Grid>
                </Grid>
            </TabItem>

            <!-- Network Tab -->
            <TabItem Header="Network" FontSize="14">
                <Border Background="{StaticResource SurfaceBrush}" CornerRadius="5" Padding="15" Margin="10">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <materialIcons:MaterialIcon Kind="RouterWireless" Foreground="{StaticResource TextBrush}" Width="18" Height="18" Margin="0,0,10,0"/>
                            <TextBlock Text="Network" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource TextBrush}"/>
                        </StackPanel>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <TextBlock Text="UPnP Port Forwarding" Foreground="{StaticResource TextBrush}" FontWeight="Bold"/>
                                <TextBlock Text="Automatically map ports for external access." Foreground="#AAAAAA" FontSize="11" TextWrapping="Wrap" Margin="0,2,0,0"/>
                            </StackPanel>
                             <CheckBox x:Name="UpnpToggle" Click="UpnpToggle_Click" VerticalAlignment="Center" HorizontalAlignment="Right">
                                 <CheckBox.LayoutTransform>
                                     <ScaleTransform ScaleX="1.2" ScaleY="1.2"/>
                                 </CheckBox.LayoutTransform>
                             </CheckBox>
                        </Grid>

                        <StackPanel Orientation="Horizontal" Margin="0,15,0,0">
                             <TextBlock Text="Status: " Foreground="#888888" FontSize="12"/>
                             <TextBlock x:Name="UpnpStatus" Text="Disabled" Foreground="#AAAAAA" FontWeight="SemiBold" FontSize="12"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </TabItem>
        </TabControl>

        <!-- Footer -->
        <Button Grid.Row="2" Content="Close" Click="Close_Click" 
                Width="100" Height="35" HorizontalAlignment="Center" Margin="0,20,0,0"
                Background="{StaticResource SurfaceBrush}" Foreground="{StaticResource TextBrush}"/>
    </Grid>
</Window>
